<%@page import="java.util.List"%>
<%@page import="com.google.gson.JsonObject"%>
<%@page import="com.biosensetek.ResultUtil"%>
<%@page import="java.sql.ResultSet,java.sql.Statement,java.sql.Connection"%>
<%@page import="com.biosensetek.DBUtils"%>
<%@page import="java.util.Arrays"%>
<%@page import="com.biosensetek.WebUtils"%>
<%@page contentType="text/html;charset=UTF-8" pageEncoding="UTF-8"%><%
try (Connection conn = DBUtils.conn("main")) {
	try (Statement stat = conn.createStatement()) {
		try (ResultSet rs = stat.executeQuery("SELECT COUNT(0)`found`FROM usr WHERE status>=0")) {
			ResultUtil.attr(rs, request);
		}
		try (ResultSet rs = stat.executeQuery("SELECT uid,account,display,name,status FROM usr WHERE status>=0")) {
			request.setAttribute("usrs", ResultUtil.jsonlist(rs));
		}
	}
}
%><!DOCTYPE html><html><head><meta charset="UTF-8"><title>帳號管理</title></head>
<body>
<div class="wrapper wrapper-content animated fadeInRight">
   <div class="row">
      <div class="col-lg-12">
         <div class="ibox float-e-margins">
            <div class="ibox-title">
               <div class="ibox-tools">
                  <a class="collapse-link">
                  <i class="fa fa-chevron-up"></i>
                  </a>
               </div>
            </div>
            <div class="ibox-content">
               <div class="table-responsive">
                  <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper form-inline dt-bootstrap">
                     <div>共 ${found} 筆</div>
                     <table class="table table-striped table-bordered table-hoverdataTable" role="grid">
                        <thead>
                           <tr role="row"><th>項次</th><th>帳號</th><th>顯示</th><th>姓名</th><th>狀態</th>
                              <th style="width:180px;"><a href="#"><i class="fa fa-plus text-warning"></i></a></th>
                           </tr>
                        </thead>
                        <tbody><%int i=0;
                        for (JsonObject j : (List<JsonObject>) request.getAttribute("usrs")) {%>
                           <tr class="gradeA odd" role="row">
                              <td><%=(++i)%></td><td><%=j.get("account").getAsString()%></td><td><%=j.get("display").getAsString()%></td><td><%=j.get("name").getAsString()%></td>
                              <td><span class="badge badge-primary">使用中</span></td>
                              <td><a href="#"><i class="fa fa-cog text-navy"></i></a>&nbsp;
                              <a href="#"><i class="fa fa-pencil text-success"></i></a>
                              </td>
                           </tr>
                        <%}
                        %></tbody>
                     </table>
                     <div class="dataTables_paginate"><jsp:include page="/WEB-INF/unit/pager.jsp"/></div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
</body>
</html><%
request.setAttribute("breadcrumb", Arrays.asList("帳號管理"));
%>